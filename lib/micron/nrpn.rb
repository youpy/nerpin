module Micron
  class Nrpn
    attr_reader :id, :key, :min, :max

    def self.find_by_key(key)
      NRPN[key]
    end

    def initialize(id, key, min, max)
      @id  = id
      @key = key
      @min = min
      @max = max
    end

    def value_at(scale)
      (((min.abs + max) * scale) - min.abs).to_i
    end

    def sample
      rand(min.abs + max + (min < 0 ? 2 : 1)) - min.abs - (min < 0 ? 1 : 0)
    end

    # ruby -rmicron -e "Micron::SpecParser.parse.each {|k, v| puts ':%s => [%i, %i, %i],' % [k,v[0], v[1], v[2]]}"
    NRPN = Hash[
      {
        :polyphony => [0, 0, 1],
        :unison_voices => [1, 0, 3],
        :unison_detune => [2, 0, 100],
        :portamento_enabled => [3, 0, 2],
        :portamento_type => [4, 0, 3],
        :portamento_time => [5, 0, 127],
        :pitchwheel_type => [6, 0, 1],
        :analog_drift => [7, 0, 100],
        :oscillator_sync_type => [8, 0, 4],
        :fm_amount => [9, 0, 1000],
        :fm_type => [10, 0, 5],
        :oscillator_1_waveform => [11, 0, 2],
        :oscillator_1_wave_shape => [12, -100, 100],
        :oscillator_1_octave => [13, -3, 3],
        :oscillator_1_transpose => [14, -7, 7],
        :oscillator_1_pitch => [15, -999, 999],
        :oscillator_1_pitchwheel_range => [16, 0, 12],
        :oscillator_2_waveform => [17, 0, 2],
        :oscillator_2_wave_shape => [18, -100, 100],
        :oscillator_2_octave => [19, -3, 3],
        :oscillator_2_transpose => [20, -7, 7],
        :oscillator_2_pitch => [21, -999, 999],
        :oscillator_2_pitchwheel_range => [22, 0, 12],
        :oscillator_3_waveform => [23, 0, 2],
        :oscillator_3_wave_shape => [24, -100, 100],
        :oscillator_3_octave => [25, -3, 3],
        :oscillator_3_transpose => [26, -7, 7],
        :oscillator_3_pitch => [27, -999, 999],
        :oscillator_3_pitchwheel_range => [28, 0, 12],
        :oscillator1_level => [29, 0, 100],
        :oscillator2_level => [30, 0, 100],
        :oscillator3_level => [31, 0, 100],
        :ringmodulation_level => [32, 0, 100],
        :noise_level => [33, 0, 100],
        :extin_level => [34, 0, 100],
        :oscillator1_balance => [35, -50, 50],
        :oscillator2_balance => [36, -50, 50],
        :oscillator3_balance => [37, -50, 50],
        :ringmodulation_balance => [38, -50, 50],
        :noise_balance => [39, -50, 50],
        :extin_balance => [40, -50, 50],
        :series_level => [41, 0, 100],
        :noise_type => [42, 0, 1],
        :filter_1_type => [43, 0, 20],
        :filter_1_frequency => [44, 0, 1023],
        :filter_1_resonance => [45, 0, 100],
        :filter_1_key_track => [46, -100, 200],
        :filter_1_envelope_amount => [47, -100, 100],
        :filter_2_relative_to_1 => [48, 0, 1],
        :filter_2_type => [49, 0, 20],
        :filter_2_frequency_absolute => [50, 0, 1023],
        :filter_2_resonance => [51, 0, 100],
        :filter_2_key_track => [52, -100, 200],
        :filter_2_envelope_amount => [53, -100, 100],
        :filter_1_level => [54, 0, 100],
        :filter_2_level => [55, 0, 100],
        :preminusfilter_level => [56, 0, 100],
        :filter_1_pan => [57, -100, 100],
        :filter_2_pan => [58, -100, 100],
        :preminusfilter_pan => [59, -100, 100],
        :preminusfilter_source => [60, 0, 6],
        :filter_1_invert_phase => [61, 0, 1],
        :drive_type => [62, 0, 6],
        :drive_level => [63, 0, 100],
        :program_level => [64, 0, 100],
        :fx_mix => [65, -50, 50],
        :envelope_1_attack_time => [66, 0, 255],
        :envelope_1_attack_slope => [67, 0, 2],
        :envelope_1_decay_time => [68, 0, 255],
        :envelope_1_decay_slope => [69, 0, 2],
        :envelope_1_sustain_time => [70, 0, 255],
        :envelope_1_sustain_level => [71, 0, 100],
        :envelope_1_release_time => [72, 0, 255],
        :envelope_1_release_slope => [73, 0, 2],
        :envelope_1_velocity_to_envelope => [74, 0, 100],
        :envelope_1_reset_every_note => [75, 0, 1],
        :envelope_1_free_run => [76, 0, 1],
        :envelope_1_loop => [77, 0, 3],
        :envelope_1_sustain_pedal => [78, 0, 1],
        :envelope_2_attack_time => [79, 0, 255],
        :envelope_2_attack_slope => [80, 0, 2],
        :envelope_2_decay_time => [81, 0, 255],
        :envelope_2_decay_slope => [82, 0, 2],
        :envelope_2_sustain_time => [83, 0, 255],
        :envelope_2_sustain_level => [84, -100, 100],
        :envelope_2_release_time => [85, 0, 255],
        :envelope_2_release_slope => [86, 0, 2],
        :envelope_2_velocity_to_envelope => [87, 0, 100],
        :envelope_2_reset_every_note => [88, 0, 1],
        :envelope_2_free_run => [89, 0, 1],
        :envelope_2_loop => [90, 0, 3],
        :envelope_2_sustain_pedal => [91, 0, 1],
        :envelope_3_attack_time => [92, 0, 255],
        :envelope_3_attack_slope => [93, 0, 2],
        :envelope_3_decay_time => [94, 0, 255],
        :envelope_3_decay_slope => [95, 0, 2],
        :envelope_3_sustain_time => [96, 0, 255],
        :envelope_3_sustain_level => [97, -100, 100],
        :envelope_3_release_time => [98, 0, 255],
        :envelope_3_release_slope => [99, 0, 2],
        :envelope_3_velocity_to_envelope => [100, 0, 100],
        :envelope_3_reset_every_note => [101, 0, 1],
        :envelope_3_free_run => [102, 0, 1],
        :envelope_3_loop => [103, 0, 3],
        :envelope_3_sustain_pedal => [104, 0, 1],
        :lfo_1_tempo_sync => [105, 0, 1],
        :lfo_1_rate_free => [106, 0, 1023],
        :lfo_1_reset => [107, 0, 6],
        :m1_slider_influencelfo_1 => [108, 0, 100],
        :lfo_2_tempo_sync => [109, 0, 1],
        :lfo_2_rate_free => [110, 0, 1023],
        :lfo_2_reset => [111, 0, 6],
        :m1_slider_influencelfo_2 => [112, 0, 100],
        :s_h_tempo_sync => [113, 0, 1],
        :s_h_rate_free => [114, 0, 1023],
        :s_h_reset => [115, 0, 4],
        :s_h_input => [116, 0, 1],
        :s_h_smoothing => [117, 0, 100],
        :tracking_input => [118, 0, 111],
        :tracking_preset => [119, 0, 9],
        :tracking_gridsize => [120, 0, 1],
        :tracking_point_minus16 => [121, -100, 100],
        :tracking_point_minus15 => [122, -100, 100],
        :tracking_point_minus14 => [123, -100, 100],
        :tracking_point_minus13 => [124, -100, 100],
        :tracking_point_minus12 => [125, -100, 100],
        :tracking_point_minus11 => [126, -100, 100],
        :tracking_point_minus10 => [127, -100, 100],
        :tracking_point_minus9 => [128, -100, 100],
        :tracking_point_minus8 => [129, -100, 100],
        :tracking_point_minus7 => [130, -100, 100],
        :tracking_point_minus6 => [131, -100, 100],
        :tracking_point_minus5 => [132, -100, 100],
        :tracking_point_minus4 => [133, -100, 100],
        :tracking_point_minus3 => [134, -100, 100],
        :tracking_point_minus2 => [135, -100, 100],
        :tracking_point_minus1 => [136, -100, 100],
        :tracking_point_0 => [137, -100, 100],
        :tracking_point_1 => [138, -100, 100],
        :tracking_point_2 => [139, -100, 100],
        :tracking_point_3 => [140, -100, 100],
        :tracking_point_4 => [141, -100, 100],
        :tracking_point_5 => [142, -100, 100],
        :tracking_point_6 => [143, -100, 100],
        :tracking_point_7 => [144, -100, 100],
        :tracking_point_8 => [145, -100, 100],
        :tracking_point_9 => [146, -100, 100],
        :tracking_point_10 => [147, -100, 100],
        :tracking_point_11 => [148, -100, 100],
        :tracking_point_12 => [149, -100, 100],
        :tracking_point_13 => [150, -100, 100],
        :tracking_point_14 => [151, -100, 100],
        :tracking_point_15 => [152, -100, 100],
        :tracking_point_16 => [153, -100, 100],
        :program_category => [154, 0, 8],
        :knob_x => [155, 0, 161],
        :knob_y => [156, 0, 161],
        :knob_z => [157, 0, 161],
        :filter_2_frequency_relative => [158, -400, 400],
        :lfo_1_rate_follow_tempo => [159, 0, 24],
        :lfo_2_rate_follow_tempo => [160, 0, 24],
        :s_h_rate_synced => [161, 0, 24],
        :patch_cable_1_source => [180, 0, 37],
        :patch_cable_1_destination => [181, 0, 77],
        :patch_cable_1_level => [182, -1000, 1000],
        :patch_cable_1_offset => [183, -1000, 1000],
        :patch_cable_2_source => [184, 0, 37],
        :patch_cable_2_destination => [185, 0, 77],
        :patch_cable_2_level => [186, -1000, 1000],
        :patch_cable_2_offset => [187, -1000, 1000],
        :patch_cable_3_source => [188, 0, 37],
        :patch_cable_3_destination => [189, 0, 77],
        :patch_cable_3_level => [190, -1000, 1000],
        :patch_cable_3_offset => [191, -1000, 1000],
        :patch_cable_4_source => [192, 0, 37],
        :patch_cable_4_destination => [193, 0, 77],
        :patch_cable_4_level => [194, -1000, 1000],
        :patch_cable_4_offset => [195, -1000, 1000],
        :patch_cable_5_source => [196, 0, 37],
        :patch_cable_5_destination => [197, 0, 77],
        :patch_cable_5_level => [198, -1000, 1000],
        :patch_cable_5_offset => [199, -1000, 1000],
        :patch_cable_6_source => [200, 0, 37],
        :patch_cable_6_destination => [201, 0, 77],
        :patch_cable_6_level => [202, -1000, 1000],
        :patch_cable_6_offset => [203, -1000, 1000],
        :patch_cable_7_source => [204, 0, 37],
        :patch_cable_7_destination => [205, 0, 77],
        :patch_cable_7_level => [206, -1000, 1000],
        :patch_cable_7_offset => [207, -1000, 1000],
        :patch_cable_8_source => [208, 0, 37],
        :patch_cable_8_destination => [209, 0, 77],
        :patch_cable_8_level => [210, -1000, 1000],
        :patch_cable_8_offset => [211, -1000, 1000],
        :patch_cable_9_source => [212, 0, 37],
        :patch_cable_9_destination => [213, 0, 77],
        :patch_cable_9_level => [214, -1000, 1000],
        :patch_cable_9_offset => [215, -1000, 1000],
        :patch_cable_10_source => [216, 0, 37],
        :patch_cable_10_destination => [217, 0, 77],
        :patch_cable_10_level => [218, -1000, 1000],
        :patch_cable_10_offset => [219, -1000, 1000],
        :patch_cable_11_source => [220, 0, 37],
        :patch_cable_11_destination => [221, 0, 77],
        :patch_cable_11_level => [222, -1000, 1000],
        :patch_cable_11_offset => [223, -1000, 1000],
        :patch_cable_12_source => [224, 0, 37],
        :patch_cable_12_destination => [225, 0, 77],
        :patch_cable_12_level => [226, -1000, 1000],
        :patch_cable_12_offset => [227, -1000, 1000],
        :fx_balance => [230, -50, 50],
        :fx_type_0 => [231, 0, 6],
        :fx_param_a => [232, -128, 127],
        :fx_param_b => [233, -128, 127],
        :fx_param_c => [234, -128, 127],
        :fx_param_d => [235, -128, 127],
        :fx_param_e => [236, -128, 127],
        :fx_param_f => [237, -128, 127],
        :fx_param_g => [238, -128, 127],
        :fx_param_h_lfo_synced => [239, 0, 24],
        :fx2_type => [245, 0, 6],
        :fx2_param_a => [246, -32768, 32767],
        :fx2_param_b => [247, -32768, 32767],
        :fx2_param_c => [248, -32768, 32767],
        :fx2_param_d => [249, -32768, 32767],
        :fx_param_a_synced => [250, 0, 24],
        :arpeggiator_pattern => [512, 0, 31],
        :arpeggiator_pattern_multiplier => [513, 0, 6],
        :arpeggiator_length => [514, 0, 14],
        :arpeggiator_octave_range => [515, 0, 4],
        :arpeggiator_octave_span => [516, 0, 2],
        :arpeggiator_note_order => [517, 0, 5],
        :arpeggiator_enabled => [518, 0, 2],
        :arpeggiator_program_tempo => [519, 500, 2500]
      }.map do |k, v|
        id, min, max = v
        [k, new(id, k, min, max)]
      end.freeze
    ]
  end
end

